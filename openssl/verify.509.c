#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>

#include <openssl/bn.h>
//#include <openssl/md5.h>
//#include <openssl/sha.h>
//#include <openssl/rsa.h>
//#include <openssl/rand.h>

void printBN(char* msg, BIGNUM* a)
{
	char* number_str=BN_bn2hex(a);
	printf("%s %s\n",msg,number_str);
	OPENSSL_free(number_str);
}

int main()
{
	
	BN_CTX *ctx=BN_CTX_new();
	
	BIGNUM *n=BN_new();
	BIGNUM *e=BN_new();
	BIGNUM *body=BN_new();
	BIGNUM *sig=BN_new();
	BIGNUM *msg=BN_new();

	

	
	BN_hex2bn(&n,"C70E6C3F23937FCC70A59D20C30E533F7EC04EC29849CA47D523EF03348574C8A3022E465C0B7DC9889D4F8BF0F89C6C8C5535DBBFF2B3EAFBE356E74A46D91322CA36D59BC1A8E3964393F20CBCE6F9E6E899C86348787F5736691A191D5AD1D47DC29CD47FE18012AE7AEA88EA57D8CA0A0A3A1249A262197A0D24F737EBB473927B05239B12B5CEEB29DFA41402B901A5D4A69C436488DEF87EFEE3F51EE5FEDCA3A8E46631D94C25E918B9895909AEE99D1C6D370F4A1E352028E2AFD4218B01C445AD6E2B63AB926B610A4D20ED73BA7CCEFE16B5DB9F80F0D68B6CD908794A4F7865DA92BCBE35F9B3C4F927804EFF9652E60220E10773E95D2BBDB2F1");
	BN_hex2bn(&e,"010001");
	BN_hex2bn(&body,"9B80F583DE89788CF2EED92DBB8BC3780952A58B9DF1BD929639DFE67781DC4B");
	BN_hex2bn(&sig,"B9ECA708DF8DD58822FC566AD0036100CC2FD3F9E3E74ED7A54A95AC86B7E95593CCF7B9167BE8B8098DAC0A6B429645D8DAB74CEEC0096ED9F143BF001657A976E7A795A5D5C8E1D953985A706E410F8303CF72ED92053943CA3C1AA7C26E7A0505338D3E001D8FC3948A2CF176DCCDA05F82ECCA63A028193B4AAB369D9011B5B28C7667137E8E51FF32A32F3D30D5C80C58B9D281426691CA778ED7AE0231723B96990A9DE706818726A405FDB39429E0B832A3D30F02CBD6AE5FC59868D11852E4C5E0E98F3AA202CC177FA5EA4CCDA3C34DDDC0FB15BB328EA7D2F6AC57FB19235CB6A8CAEAB3BAAF22DA82D183094A5C5267AED29D6663030806971B9A");
	
	
	
	
	BN_mod_exp(msg, sig, e, n, ctx);
	printBN("the msg is", msg);
	
	
	printBN("the original body is", body);
	
	return 0;
}
